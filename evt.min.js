(function(e){function g(a){d.prototype.instances[this].handle(a)}var f=e.document.documentElement.matches,l=e.Event.prototype.stopPropagation,m=e.Event.prototype.stopImmediatePropagation;if(!f)for(var k=["ms","moz","webkit"],h=k.pop();h;){f=h+"MatchesSelector";if(f in e.document.documentElement){f=e.document.documentElement[f];break}h=k.pop()}var d=function(a){if(!(this instanceof d))return new d(a);a=a instanceof Node?a:e.document.querySelector(a);if(this.instances[a])return this.instances[a];this.el=a;this.events={};this.instances[a]=this};d.prototype.instances={};d.prototype.matches=function(a,b){return"undefined"===b?this.el===a:f.call(a,b)};d.prototype.on=function(a,b,c){"function"===typeof b&&(c=b,b=void 0);this.events[a]||(this.events[a]={},this.el.addEventListener(a,g));this.events[a][b]||(this.events[a][b]=[]);this.events[a][b].push(c);return this};d.prototype.off=function(a,b,c){if(!a&&!b&&!c)for(a in this.events)this.events.hasOwnProperty(a)&&this.el.removeEventListener(a,g);!a||b||c||(delete this.events[a],this.el.removeEventListener(a,g));a&&b&&!c&&("function"===typeof b?this.off(a,void 0,b):delete this.events[a][b],0===Object.keys(this.events[a]).length&&this.off(a));a&&b&&c&&(c=this.events[a][b].indexOf(c),this.events[a][b].splice(c,1),0===this.events[a][b].length&&this.off(a,b));return this};d.prototype.handle=function(a){function b(b){b.call(c,a);return f}var c=a.target,d=this.events[a.type],e=!1,f=!1;a.stopPropagation=function(){e=!0;l.call(this)};for(a.stopImmediatePropagation=function(){f=e=!0;m.call(this)};c!=this.el.parentNode;){for(var g in d)if(d.hasOwnProperty(g)&&(this.matches(c,g)&&d[g].some(b),e))return;c=c.parentNode}};e.Evt=d})(window);